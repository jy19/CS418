#Fixed: This code seems to get the right answers, it just merges dna that matches, and it accounts for one mismatch

import sys

def longest_contig_size(dna_list):
        longest_contig = ""
        for dna in dna_list:
                if len(dna) > len(longest_contig):
                        longest_contig = dna
        return len(longest_contig)

def shortest_contig_size(dna_list):
        shortest_contig = dna_list[0]
        for dna in dna_list:
                if len(dna) < len(shortest_contig):
                        shortest_contig = dna
        return len(shortest_contig)

def average_contig_size(dna_list):
        count = 0
        total_size = 0
        for dna in dna_list:
                count+=1
                total_size += len(dna)
        return total_size/count

with open(sys.argv[1]) as fh:
        dna_list = []
        for line in fh:
                if line[0] != ">":
                        dna_list.append(line.strip())

mismatches = 1

i=0
while(True):
        initial_dna_list_size = len(dna_list)
        for dna1 in dna_list:
                for dna2 in dna_list:           #Compare all dna in list
                        correct_count = 0
                        for c in range(shortest_contig_size([dna1[i:],dna2[:len(dna1)-i]])):
                                if dna1[i:][c] == dna2[:len(dna1)-i][c]:
                                        correct_count+=1
                        if dna1 == dna2:        #Remove duplicates
                                if dna_list.index(dna1) != dna_list.index(dna2):
                                        dna.list.remove(dna2)
                        elif correct_count >= len(dna1[i:]) - mismatches:
                                dna_list.append(dna1+dna2[len(dna1)-i:])
                                dna_list.remove(dna1)
                                dna_list.remove(dna2)
                                break
        if initial_dna_list_size == len(dna_list) and i == longest_contig_size(dna_list) - mismatches:
                break                   #End
        if i == longest_contig_size(dna_list) - mismatches:
                i = 0
        i+=1

print "\n".join(dna_list)
print "Average contig size: " + str(average_contig_size(dna_list))
print "Number of contigs returned: " + str(len(dna_list))
print "Shortest contig size: " + str(shortest_contig_size(dna_list))
print "Largest contig size: " + str(longest_contig_size(dna_list))
