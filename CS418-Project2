#This code works but it will take forever on the large datasets

import sys

def longest_contig_size(dna_list):
        longest_contig = ""
        for dna in dna_list:
                if len(dna) > len(longest_contig):
                        longest_contig = dna
        return len(longest_contig)

def shortest_contig_size(dna_list):
        shortest_contig = dna_list[0]
        for dna in dna_list:
                if len(dna) < len(shortest_contig):
                        shortest_contig = dna
        return len(shortest_contig)

def average_contig_size(dna_list):
        count = 0
        total_size = 0
        for dna in dna_list:
                count+=1
                total_size += len(dna)
        return total_size/count

with open(sys.argv[1]) as fh:
        dna_list = []
        for line in fh:
                if line[0] != ">":
                        dna_list.append(line.strip())

mismatches = 1

initial_dna_list_size = 0
while(len(dna_list) != 1 and initial_dna_list_size != len(dna_list)):
        initial_dna_list_size = len(dna_list)                   #Prepends or appends dna on another dna
        print len(dna_list)
        for i in range(longest_contig_size(dna_list)):
                for dna1 in dna_list:
                        for dna2 in dna_list:
                                if len(dna1) <= len(dna2) and i < len(dna1) and dna1 != dna2:
                                        correct_prepend_count = 0
                                        correct_append_count = 0
                                        for c in range(len(dna1)-i):
                                                if dna1[i:][c] == dna2[c]:
                                                        correct_prepend_count += 1
                                                if dna1[:len(dna1)-i][c] == dna2[len(dna2)-len(dna1)+i:][c]:
                                                        correct_append_count += 1
                                        if correct_prepend_count >= len(dna1[i:]) - mismatches:
                                                dna_list.append(dna1+dna2[len(dna1)-i:])
                                                dna_list.remove(dna1)
                                                dna_list.remove(dna2)
                                                break
                                        elif correct_append_count >= len(dna1[i:]) - mismatches:
                                                dna_list.append(dna2+dna1[len(dna1)-i:])
                                                dna_list.remove(dna1)
                                                dna_list.remove(dna2)
                                                break
                        if initial_dna_list_size != len(dna_list):
                                break
                if initial_dna_list_size != len(dna_list):
                        break


print "\n".join(dna_list)
print "Average contig size: " + str(average_contig_size(dna_list))
print "Number of contigs returned: " + str(len(dna_list))
print "Largest contig size: " + str(longest_contig_size(dna_list))
print "Shortest contig size: " + str(shortest_contig_size(dna_list))
