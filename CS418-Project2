#This code seems to get the right answers, it just merges dna that matches, but it doesn't account for errors

import sys

def longest_contig_size(dna_list):
        longest_contig = ""
        for dna in dna_list:
                if len(dna) > len(longest_contig):
                        longest_contig = dna
        return len(longest_contig)

def average_contig_size(dna_list):
        count = 0
        total_size = 0
        for dna in dna_list:
                count+=1
                total_size += len(dna)
        return total_size/count

with open(sys.argv[1]) as fh:
        dna_list = []
        for line in fh:
                if line[0] != ">":
                        dna_list.append(line.strip())

i=1
while(True):
        for dna1 in dna_list:
                for dna2 in dna_list:                                                   #Compare each dna strand in dna_list
                        if dna1 == dna2:
                                if dna_list.index(dna1) != dna_list.index(dna2):
                                        dna_list.remove(dna2)
                        elif dna1[i:] == dna2[:len(dna1)-i]:                            #If back of one equals front of another
                                dna_list.append(dna1+dna2[len(dna1)-i:])                #Join and add to list
                                dna_list.remove(dna1)                                   #Remove original two
                                dna_list.remove(dna2)
                                i=0
                                break
                if i==0:
                        break
        if len(dna_list) == 1 or i > longest_contig_size(dna_list):
                break
        i+=1

print "\n".join(dna_list)
print "Average contig size: " + str(average_contig_size(dna_list))
print "Number of contigs returned: " + str(len(dna_list))
print "Largest contig size: " + str(longest_contig_size(dna_list))
